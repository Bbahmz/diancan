{include file="public/header" /}
<style>

</style>

<div id="dcWrap">
    {include file="public/lefter" /}
    <div id="dcMain">
        <!-- 当前位置 -->
        <div id="urHere">管理中心<b>></b><strong>统计列表</strong></div>
        <div class="mainBox" style="height:auto!important;height:550px;min-height:550px;">
            <h3>数据统计</h3>

            <div class="items">
                <div id="day" class="statistical-items clearfix">
                    <form class="clearfix" action="{:url('statistical/index')}">
                        <input type="text" name="start" value="{$date['start']}" size="15" class="inpMain date-picker" />&nbsp;&nbsp;~&nbsp;
                        <input type="text" name="end" value="{$date['end']}" size="15" class="inpMain date-picker" />
                        <input type="hidden" name="type" value="default" />
                        <button class="btn form-pull" type="submit" style="margin-left: 15px;">统计</button>
                    </form>
                    <ul class="clearfix">
                        <li><a href="{:url('statistical/index', ['type'=>'today'])}" class="btn btn-success">日报</a></li>
                        <li><a href="{:url('statistical/index', ['type'=>'week'])}" class="btn btn-info">周报</a></li>
                        <li><a href="{:url('statistical/index', ['type'=>'mouth'])}" class="btn btn-warning">月报</a></li>
                        <li><a href="{:url('statistical/index', ['type'=>'year'])}" class="btn btn-danger">年报</a></li>
                    </ul>
                </div>
            </div>
            <!-- 统计表格 -->
            <div class="statistical clearfix">
                <div class="s-left">
                    <div class="col">
                        <div class="card-panel text-center">
                            <h4 class="h4-default">营业额 (元)</h4>
                            <div class="card-content">
                                <span class="percent">{$stat['revenue']}</span>
                                <ul class="clearfix">
                                    <li ><a href="">查看图表</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card-panel text-center">
                            <h4 class="h4-blue">点单数 (个)</h4>
                            <div class="card-content">
                                <span class="percent">{$stat['oNum']}</span>
                                <ul class="clearfix">
                                    <li ><a href="">查看图表</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card-panel text-center">
                            <h4 class="h4-orange">点菜数 (个)</h4>
                            <div class="card-content">
                                <span class="percent">{$stat['dNum']}</span>
                                <ul class="clearfix">
                                    <li ><a href="">查看图表</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card-panel text-center">
                            <h4 class="h4-red">退菜数 (个)</h4>
                            <div class="card-content">
                                <span class="percent">{$stat['tdNum']}</span>
                                <ul class="clearfix">
                                    <li ><a href="">查看图表</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div id="chart" class="charts"></div>
                    <div id="chartdiv" class="charts"></div>
                </div>
                <div class="s-right">
                    <div class="col col-long">
                        <div class="card-panel text-center">
                            <h4>畅销菜品</h4>
                            <div class="card-content">
                                {if condition="$stat['sells']"}
                                <table width="100%" border="0" cellpadding="8" cellspacing="0">
                                    {volist name="stat.sells" id="vo"}
                                    <tr>
                                        <td>{$vo['Cn']}</td>
                                        <td>{$vo['num']} (份)</td>
                                    </tr>
                                    {/volist}
                                </table>
                                <ul class="clearfix">
                                    <li ><a href="">查看图表</a></li>
                                </ul>
                                {else/}
                                    <p style="height: 370px">暂无</p>
                                {/if}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
    <div class="clear"></div>
    {include file="public/footer" /}
    <div class="clear"></div>
</div>
<script type="text/javascript">
    $.datetimepicker.setLocale('ch');//设置中文
    $(".date-picker").datetimepicker({
        format:"Y-m-d",      //格式化日期
        timepicker:false,    //关闭时间选项
    });
</script>
<script src="__PUBLIC__/js/amcharts/amcharts.js" type="text/javascript"></script>
<script src="__PUBLIC__/js/amcharts/serial.js" type="text/javascript"></script>
<script type="text/javascript">
    // 营业额折线图
    // generate data
    var chartData = {$jsonRevenue};

    var chart = AmCharts.makeChart("chart", {
        "type": "serial",
        "theme": "light",
        "titles":[{"text":"营业额"}],
        "autoMarginOffset": 20,
        "dataProvider": chartData,
        "valueAxes": [{
            "axisAlpha": 0
        }],
        "balloon": {
            "cornerRadius": 6
        },
        "synchronizeGrid":true,
        "graphs": [{
            "balloonText": "[[title]]: [[category]] [[value]] 元",
            "lineThickness": 2,
            "title": "营业额",
            "valueField": "revenue"
        }],
        "chartCursor": {
            "cursorPosition": "mouse",
            "showNextAvailable": true
        },
        "chartCursor": {
            "cursorPosition": "mouse"
        },
        "chartScrollbar": {},
        "categoryField": "date",
        "categoryAxis": {
            "minPeriod": "YYYY",
            "parseDates": false,
            "axisColor": "#DADADA",
            "minorGridEnabled": true
        },
        "export": {
            "enabled": true
        }
    });
    // 柱状图
    var chart = AmCharts.makeChart("chartdiv", {
        "type": "serial",
        "theme": "light",
        "categoryField": "day",
        "startDuration": 1,
        "categoryAxis": {
            "gridPosition": "start",
            "axisAlpha": 0.3,
            "gridAlpha": 0,
            "position": "left"
        },
        "legend": {
            "horizontalGap": 10,
            "maxColumns": 1,
            "position": "right",
            "useGraphSettings": true,
            "markerSize": 10
        },
        "trendLines": [],
        "graphs": [
            {
                "balloonText": "<b>[[title]]</b><br><span style='font-size:14px'>[[category]]: <b>[[value]] 个</b></span>",
                "fillColors": "#2196F3",
                "fillAlphas": 0.8,
                "labelText": "[[value]]",
                "lineAlpha": 0.3,
                "title": "点单数",
                "type": "column",
                "color": "#000000",
                "valueField": "oNum"
            },
            {
                "balloonText": "<b>[[title]]</b><br><span style='font-size:14px'>[[category]]: <b>[[value]] 个</b></span>",
                "fillColors": "#ff9800",
                "fillAlphas": 0.8,
                "labelText": "[[value]]",
                "lineAlpha": 0.3,
                "title": "点菜数",
                "type": "column",
                "color": "#000000",
                "valueField": "dNum"
            },
            {
                "balloonText": "<b>[[title]]</b><br><span style='font-size:14px'>[[category]]: <b>[[value]] 个</b></span>",
                "fillColors": "#F44336",
                "fillAlphas": 0.8,
                "labelText": "[[value]]",
                "lineAlpha": 0.3,
                "title": "退菜数",
                "type": "column",
                "color": "#000000",
                "valueField": "tdNum"
            }
        ],
        "guides": [],
        "valueAxes": [
            {
                "position": "left",
                "axisAlpha": 0.3,
                "gridAlpha": 0,
            }
        ],
        "allLabels": [],
        "balloon": {},
        "titles": [{"text":"订单"}],
        "dataProvider": [
            {
                "day": '2017-02-09',
                "oNum": 0,
                "dNum": 2,
                "tdNum": 0
            },
            {
                "day": '2017-02-10',
                "oNum": 11,
                "dNum": 21,
                "tdNum": 0
            }
        ],
        "export": {
            "enabled": true
        }

    });
</script>